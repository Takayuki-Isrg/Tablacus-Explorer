# 基本設計書

## 1. 目的

Tablacus Explorer の各ペインに開いているタブを一覧表示し、  
フィルタやクリック操作で **即座にタブを切り替えられるユーティリティ** を提供する。

## 2. システム構成概要

| レイヤ           | モジュール    | 主な責務                                                             |
| :--------------- | :------------ | :------------------------------------------------------------------- |
| **UI**           | `dialog.html` | 画面レイアウト（フィルタ入力＋タブ一覧テーブル）                     |
| **UI ロジック**  | `dialog.js`   | タブ一覧生成・描画、入力／クリック／リサイズイベント処理             |
| **アドオン本体** | `script.js`   | アドオン登録、メニュー・キー割当、ダイアログ生成／破棄、イベント伝播 |
| **メタ情報**     | `config.xml`  | バージョン・名称・最小実行環境などアドオン定義                       |

## 3. 機能一覧

| No  | 機能名               | 概要                                                                                                |
| :-: | :------------------- | :-------------------------------------------------------------------------------------------------- |
| F1  | ダイアログ呼出し     | ツールバー／メニュー／キー／マウスジェスチャで `Addons.TabList.Exec()` を呼び出し、ダイアログを表示 |
| F2  | タブ一覧生成         | 全ペイン (`te.Ctrls(CTRL_TC)`) からタブ名・パスを取得し、フィルタ文字列で絞り込み (`PathMatchEx`)   |
| F3  | タブ切替             | 一覧行クリックで当該タブをアクティブ化 (`TC.SelectedIndex`)                                         |
| F4  | コンテキストメニュー | 右クリックで標準コンテキストメニューを表示 (`te.OnShowContextMenu()`)                               |
| F5  | フィルタリング       | 入力欄のキー押下後 500 ms 後に再描画 (`KeyDown`)                                                    |
| F6  | サイズ記憶           | ダイアログ閉鎖時に座標・幅高を JSON 保存、次回読み込み (`Resize`)                                   |

## 4. データフロー

```text
[ユーザ操作]
  └─ Exec() → ダイアログ表示 (`dialog.html`)
      └─ InitDialog() → Changed()
          ├─ te.Ctrls(CTRL_TC) で全 TabCtrl 取得
          ├─ 各 TabCtrl からタブ情報を取得
          └─ テーブル描画 (`ShowTabList`)
```

## 5. 外部インタフェース

| 区分     | 仕様                                             |
| :------- | :----------------------------------------------- |
| 呼出し元 | Tablacus Explorer 本体（メニュー／キー／マウス） |
| 呼出し先 | なし                                             |
| 保存先   | `%AppData%\TablacusExplorer\config\tablist.json` |

## 6. 非機能要件

性能: フィルタ再描画は 0.5 秒以上空けて実行
互換性: Tablacus Explorer v2022-02-23 以降
